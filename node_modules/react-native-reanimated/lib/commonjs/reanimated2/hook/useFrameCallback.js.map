{"version":3,"names":["frameCallbackRegistry","FrameCallbackRegistryJS","useFrameCallback","callback","autostart","ref","useRef","setActive","isActive","manageStateFrameCallback","current","callbackId","useEffect","registerFrameCallback","unregisterFrameCallback"],"sources":["useFrameCallback.ts"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport FrameCallbackRegistryJS from '../frameCallback/FrameCallbackRegistryJS';\nimport { FrameInfo } from '../frameCallback/FrameCallbackRegistryUI';\n\nexport type FrameCallback = {\n  setActive: (isActive: boolean) => void;\n  isActive: boolean;\n  callbackId: number;\n};\nconst frameCallbackRegistry = new FrameCallbackRegistryJS();\n\nexport function useFrameCallback(\n  callback: (frameInfo: FrameInfo) => void,\n  autostart = true\n): FrameCallback {\n  const ref = useRef<FrameCallback>({\n    setActive: (isActive: boolean) => {\n      frameCallbackRegistry.manageStateFrameCallback(\n        ref.current.callbackId,\n        isActive\n      );\n      ref.current.isActive = isActive;\n    },\n    isActive: autostart,\n    callbackId: -1,\n  });\n\n  useEffect(() => {\n    ref.current.callbackId =\n      frameCallbackRegistry.registerFrameCallback(callback);\n    ref.current.setActive(ref.current.isActive);\n\n    return () => {\n      frameCallbackRegistry.unregisterFrameCallback(ref.current.callbackId);\n      ref.current.callbackId = -1;\n    };\n  }, [callback, autostart]);\n\n  return ref.current;\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;;;AAQA,MAAMA,qBAAqB,GAAG,IAAIC,gCAAJ,EAA9B;;AAEO,SAASC,gBAAT,CACLC,QADK,EAGU;EAAA,IADfC,SACe,uEADH,IACG;EACf,MAAMC,GAAG,GAAG,IAAAC,aAAA,EAAsB;IAChCC,SAAS,EAAGC,QAAD,IAAuB;MAChCR,qBAAqB,CAACS,wBAAtB,CACEJ,GAAG,CAACK,OAAJ,CAAYC,UADd,EAEEH,QAFF;MAIAH,GAAG,CAACK,OAAJ,CAAYF,QAAZ,GAAuBA,QAAvB;IACD,CAP+B;IAQhCA,QAAQ,EAAEJ,SARsB;IAShCO,UAAU,EAAE,CAAC;EATmB,CAAtB,CAAZ;EAYA,IAAAC,gBAAA,EAAU,MAAM;IACdP,GAAG,CAACK,OAAJ,CAAYC,UAAZ,GACEX,qBAAqB,CAACa,qBAAtB,CAA4CV,QAA5C,CADF;IAEAE,GAAG,CAACK,OAAJ,CAAYH,SAAZ,CAAsBF,GAAG,CAACK,OAAJ,CAAYF,QAAlC;IAEA,OAAO,MAAM;MACXR,qBAAqB,CAACc,uBAAtB,CAA8CT,GAAG,CAACK,OAAJ,CAAYC,UAA1D;MACAN,GAAG,CAACK,OAAJ,CAAYC,UAAZ,GAAyB,CAAC,CAA1B;IACD,CAHD;EAID,CATD,EASG,CAACR,QAAD,EAAWC,SAAX,CATH;EAWA,OAAOC,GAAG,CAACK,OAAX;AACD"}